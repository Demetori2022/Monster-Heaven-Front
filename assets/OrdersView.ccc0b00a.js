import{_ as O,a as y,r as b,D as q,o as s,c as l,e as c,d as t,w as g,am as x,S as h,a8 as f,an as w,aq as S,p as B,f as P,ap as r,ao as A,g as E,i as L}from"./index.9adaeed2.js";import{_ as z}from"./Space.69b9bd99.js";import{_ as F}from"./Pagination.2bce9e0b.js";import{_ as M,a as T}from"./Table.d3a2ff76.js";import"./Input.f170982d.js";import"./Tag.156a7dd8.js";const V=_=>(B("data-v-66f390e5"),_=_(),P(),_),U={id:"ordersbox"},$=V(()=>t("h1",{class:"title"},"\u8A02\u55AE\u7BA1\u7406",-1)),j=V(()=>t("thead",null,[t("tr",null,[t("th",null,"\u8A02\u55AEID"),t("th",null,"\u65E5\u671F"),t("th",null,"\u4F7F\u7528\u8005"),t("th",null,"\u91D1\u984D"),t("th",null,"\u5546\u54C1"),t("th",null,"\u7DE8\u8F2F")])],-1)),G=E("\u522A\u9664"),H={__name:"OrdersView",setup(_){const i=y([]);y([]);const u=b(1),p=12,v=q(()=>i.slice(u.value*p-p,u.value*p)),k=async(a,n)=>{try{await x.delete("/orders/"+a),h.fire({icon:"success",title:"\u6210\u529F",text:"\u522A\u9664\u6210\u529F"}),i.splice(n,1)}catch(o){h.fire({icon:"error",title:"\u5931\u6557",text:o.isAxiosError?o.response.data.message:o.message})}};return(async()=>{try{const{data:a}=await x.get("/orders/all");i.push(...a.result.map(n=>(n.totalPrice=n.products.reduce((o,d)=>o+d.product.price*d.quantity,0),n)))}catch(a){console.log(a),h.fire({icon:"error",title:"\u5931\u6557",text:"\u7121\u6CD5\u53D6\u5F97\u8A02\u55AE"})}})(),(a,n)=>{const o=M,d=L,D=T,I=z,C=F;return s(),l("div",U,[$,c(o),t("div",null,[c(I,{vertical:""},{default:g(()=>[c(D,{striped:""},{default:g(()=>[j,t("tbody",null,[(s(!0),l(f,null,w(S(v),(e,N)=>(s(),l(f,null,[S(v).length>0?(s(),l("tr",{key:e._id},[t("td",null,r(e._id),1),t("td",null,r(new Date(e.date).toLocaleDateString()),1),t("td",null,r(e.user.account),1),t("td",null,r(e.totalPrice),1),t("td",null,[t("ul",null,[(s(!0),l(f,null,w(e.products,m=>(s(),l("li",{key:m._id},r(m.product.name)+" x "+r(m.quantity),1))),128))])]),t("td",null,[c(d,{type:"error",onClick:m=>k(e._id,N)},{default:g(()=>[G]),_:2},1032,["onClick"])])])):A("",!0)],64))),256))])]),_:1})]),_:1})]),c(C,{page:u.value,"onUpdate:page":n[0]||(n[0]=e=>u.value=e),"page-count":Math.ceil(i.length/p)},null,8,["page","page-count"])])}}},Z=O(H,[["__scopeId","data-v-66f390e5"]]);export{Z as default};
