import{_ as q,a as w,r as B,D as P,o,c as s,e as r,d as t,w as g,am as S,S as h,a8 as f,an as V,aq as C,p as A,f as E,ap as _,ao as v,g as D,i as L}from"./index.f3cb17e8.js";import{_ as $}from"./Space.beb61ca3.js";import{_ as z}from"./Pagination.da162fb4.js";import{_ as F,a as M}from"./Table.de7d361b.js";import"./Input.79a4c884.js";import"./Tag.2dbb3e6b.js";const I=d=>(A("data-v-7e9288fc"),d=d(),E(),d),T={id:"ordersbox"},U=I(()=>t("h1",{class:"title"},"\u8A02\u55AE\u7BA1\u7406",-1)),j=I(()=>t("thead",null,[t("tr",null,[t("th",null,"\u8A02\u55AEID"),t("th",null,"\u65E5\u671F"),t("th",null,"\u4F7F\u7528\u8005"),t("th",null,"\u91D1\u984D"),t("th",null,"\u5546\u54C1"),t("th",null,"\u7DE8\u8F2F")])],-1)),G={key:0},H=D("\u522A\u9664"),J={key:1},K=D("\u522A\u9664"),Q={__name:"OrdersView",setup(d){const m=w([]);w([]);const a=B(1),i=5,y=P(()=>m.slice(a.value*i-i,a.value*i)),x=async(c,n)=>{try{await S.delete("/orders/"+c),h.fire({icon:"success",title:"\u6210\u529F",text:"\u522A\u9664\u6210\u529F"}),m.splice(n,1)}catch(l){h.fire({icon:"error",title:"\u5931\u6557",text:l.isAxiosError?l.response.data.message:l.message})}};return(async()=>{try{const{data:c}=await S.get("/orders/all");m.push(...c.result.map(n=>(n.totalPrice=n.products.reduce((l,u)=>l+u.product.price*u.quantity,0),n)))}catch(c){console.log(c),h.fire({icon:"error",title:"\u5931\u6557",text:"\u7121\u6CD5\u53D6\u5F97\u8A02\u55AE"})}})(),(c,n)=>{const l=F,u=L,N=M,O=$,b=z;return o(),s("div",T,[U,r(l),t("div",null,[r(O,{vertical:""},{default:g(()=>[r(N,{striped:""},{default:g(()=>[j,t("tbody",null,[(o(!0),s(f,null,V(C(y),(e,k)=>(o(),s(f,null,[C(y).length>0?(o(),s("tr",{key:e._id},[t("td",null,_(e._id),1),t("td",null,_(new Date(e.date).toLocaleDateString()),1),t("td",null,_(e.user.account),1),t("td",null,_(e.totalPrice),1),t("td",null,[t("ul",null,[(o(!0),s(f,null,V(e.products,p=>(o(),s("li",{key:p._id},_(p.product.name)+" x "+_(p.quantity),1))),128))])]),a.value===1?(o(),s("td",G,[r(u,{type:"error",onClick:p=>x(e._id,k)},{default:g(()=>[H]),_:2},1032,["onClick"])])):v("",!0),a.value>1?(o(),s("td",J,[r(u,{type:"error",onClick:p=>x(e._id,k+(a.value-1)*i)},{default:g(()=>[K]),_:2},1032,["onClick"])])):v("",!0)])):v("",!0)],64))),256))])]),_:1})]),_:1})]),r(b,{page:a.value,"onUpdate:page":n[0]||(n[0]=e=>a.value=e),"page-count":Math.ceil(m.length/i)},null,8,["page","page-count"])])}}},nt=q(Q,[["__scopeId","data-v-7e9288fc"]]);export{nt as default};
