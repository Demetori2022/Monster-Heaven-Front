import{_ as N,a as x,r as O,D as b,o as s,c as l,e as c,d as t,w as h,am as y,S as f,a8 as v,an as w,aq as S,p as q,f as B,ap as r,ao as P,g as A,i as E}from"./index.27586df5.js";import{_ as L}from"./Space.7724acde.js";import{_ as z}from"./Pagination.ce6208db.js";import{_ as F,a as M}from"./Table.59de1965.js";import"./Input.c97bbfe0.js";import"./Tag.5329d263.js";const V=i=>(q("data-v-e3830238"),i=i(),B(),i),T={id:"ordersbox"},U=V(()=>t("h1",{class:"title"},"\u8A02\u55AE\u7BA1\u7406",-1)),$=V(()=>t("thead",null,[t("tr",null,[t("th",null,"\u8A02\u55AEID"),t("th",null,"\u65E5\u671F"),t("th",null,"\u4F7F\u7528\u8005"),t("th",null,"\u91D1\u984D"),t("th",null,"\u5546\u54C1"),t("th",null,"\u7DE8\u8F2F")])],-1)),j=A("\u522A\u9664"),G={__name:"OrdersView",setup(i){const g=x([]);x([]);const _=O(1),u=1,p=b(()=>g.slice(_.value*u-u,_.value*u)),k=async o=>{const a=p.value.findIndex(e=>e._id===o);try{await y.delete("/orders/"+o),f.fire({icon:"success",title:"\u6210\u529F",text:"\u522A\u9664\u6210\u529F"}),p.value.splice(a,1)}catch(e){f.fire({icon:"error",title:"\u5931\u6557",text:e.isAxiosError?e.response.data.message:e.message})}};return(async()=>{try{const{data:o}=await y.get("/orders/all");g.push(...o.result.map(a=>(a.totalPrice=a.products.reduce((e,d)=>e+d.product.price*d.quantity,0),a)))}catch(o){console.log(o),f.fire({icon:"error",title:"\u5931\u6557",text:"\u7121\u6CD5\u53D6\u5F97\u8A02\u55AE"})}})(),(o,a)=>{const e=F,d=E,I=M,D=L,C=z;return s(),l("div",T,[U,c(e),t("div",null,[c(D,{vertical:""},{default:h(()=>[c(I,{striped:""},{default:h(()=>[$,t("tbody",null,[(s(!0),l(v,null,w(S(p),(n,J)=>(s(),l(v,null,[S(p).length>0?(s(),l("tr",{key:n._id},[t("td",null,r(n._id),1),t("td",null,r(new Date(n.date).toLocaleDateString()),1),t("td",null,r(n.user.account),1),t("td",null,r(n.totalPrice),1),t("td",null,[t("ul",null,[(s(!0),l(v,null,w(n.products,m=>(s(),l("li",{key:m._id},r(m.product.name)+" x "+r(m.quantity),1))),128))])]),t("td",null,[c(d,{type:"error",onClick:m=>k(n._id)},{default:h(()=>[j]),_:2},1032,["onClick"])])])):P("",!0)],64))),256))])]),_:1})]),_:1})]),c(C,{page:_.value,"onUpdate:page":a[0]||(a[0]=n=>_.value=n),"page-count":Math.ceil(g.length/u)},null,8,["page","page-count"])])}}},Z=N(G,[["__scopeId","data-v-e3830238"]]);export{Z as default};
