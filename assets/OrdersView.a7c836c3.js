import{_ as C,a as N,r as O,D as q,o as s,c as l,e as c,d as t,w as g,am as y,S as h,a8 as f,an as x,aq as w,p as B,f as P,ap as r,ao as A,g as E,i as L}from"./index.835e1dab.js";import{_ as z}from"./Space.0b09f2ea.js";import{_ as F}from"./Pagination.f9124e0d.js";import{_ as M,a as T}from"./Table.63e62142.js";import"./Input.a63e134e.js";import"./Tag.a7907dce.js";const b=_=>(B("data-v-cdb0f9bd"),_=_(),P(),_),U={id:"ordersbox"},$=b(()=>t("h1",{class:"title"},"\u8A02\u55AE\u7BA1\u7406",-1)),j=b(()=>t("thead",null,[t("tr",null,[t("th",null,"\u8A02\u55AEID"),t("th",null,"\u65E5\u671F"),t("th",null,"\u4F7F\u7528\u8005"),t("th",null,"\u91D1\u984D"),t("th",null,"\u5546\u54C1"),t("th",null,"\u7DE8\u8F2F")])],-1)),G=E("\u522A\u9664"),H={__name:"OrdersView",setup(_){const i=N([]),u=O(1),p=10,v=q(()=>i.slice(u.value*p-p,u.value*p)),S=async(a,n)=>{try{await y.delete("/orders/"+a),h.fire({icon:"success",title:"\u6210\u529F",text:"\u522A\u9664\u6210\u529F"}),i.splice(n,1)}catch(o){h.fire({icon:"error",title:"\u5931\u6557",text:o.isAxiosError?o.response.data.message:o.message})}};return(async()=>{try{const{data:a}=await y.get("/orders/all");i.push(...a.result.map(n=>(n.totalPrice=n.products.reduce((o,d)=>o+d.product.price*d.quantity,0),n)))}catch(a){console.log(a),h.fire({icon:"error",title:"\u5931\u6557",text:"\u7121\u6CD5\u53D6\u5F97\u8A02\u55AE"})}})(),(a,n)=>{const o=M,d=L,V=T,k=z,D=F;return s(),l("div",U,[$,c(o),t("div",null,[c(k,{vertical:""},{default:g(()=>[c(V,{striped:""},{default:g(()=>[j,t("tbody",null,[(s(!0),l(f,null,x(w(v),(e,I)=>(s(),l(f,null,[w(v).length>0?(s(),l("tr",{key:e._id},[t("td",null,r(e._id),1),t("td",null,r(new Date(e.date).toLocaleDateString()),1),t("td",null,r(e.user.account),1),t("td",null,r(e.totalPrice),1),t("td",null,[t("ul",null,[(s(!0),l(f,null,x(e.products,m=>(s(),l("li",{key:m._id},r(m.product.name)+" x "+r(m.quantity),1))),128))])]),t("td",null,[c(d,{type:"error",onClick:m=>S(e._id,I)},{default:g(()=>[G]),_:2},1032,["onClick"])])])):A("",!0)],64))),256))])]),_:1})]),_:1})]),c(D,{page:u.value,"onUpdate:page":n[0]||(n[0]=e=>u.value=e),"page-count":Math.ceil(i.length/p)},null,8,["page","page-count"])])}}},Z=C(H,[["__scopeId","data-v-cdb0f9bd"]]);export{Z as default};
